{{ include parts_html_header.html }}

<div class="showblock">
  <div>
    <h1>
      {{ $title | check_mudai }}
      {{if $is_private}}🔒{{endif}}
    </h1>
    <p class="memo">{{ $memo }}</p>
  </div>
  <div>
    <label>プログラム:<br />
    <textarea id="nako3code" name="body">{{ $body }}</textarea>
    </label><br />
    <button id="runButton" class="pure-button pure-button-primary">▶　実 行</button>
    <button id="clearButton" class="pure-button">クリア</button>
    <div id="runbox">
      <div class="nako3row nako3info" id="nako3_info"></div>
      <canvas id='nako3_canvas' width='{{$canvas_w}}' height='{{$canvas_h}}'></canvas>
      <div id='nako3_div' class='nako3_div'></div>
      <div>
        <span class="memo">
          Canvas:
          幅 <input type="text" id="canvas_w" value="{{$canvas_w}}" size="3"> ×
          高 <input type="text" id="canvas_h" value="{{$canvas_h}}" size="3">
        </span>
      </div>
    </div>
  </div>
  <ul class="devblock">
    {{if $app_id gt 0}}
    <li>
      <span>
        {{if $user_id gt 0}}
          <a href="index.php?action=list&user_id={{$user_id}}">
            <img src="{{$profile_url}}" width="48" height="48">
            {{ $author }} 作
          </a>
        {{else}}
          {{ $author }} 作
        {{endif}}
        {{ if $url }}
          (<a href="{{$url}}">関連URL</a>)
        {{ endif }}
    </span></li>
    {{endif}}
    <li>利用バージョン: {{ $version }}</li>
    <li>
      投稿日時: {{ $ctime | datetime }}
      {{ if $ctime != $mtime }}
        (編集: {{$mtime | datetime}})
      {{ endif }}
    </li>
    {{if $is_private}}
    <li>🔒 非公開の投稿</li>
    {{endif}}
  </ul>
  {{if $app_id gt 0}}
  <div class="fav_block">
    <button id="fav_button" class="pure-button">気に入った 😋</button>
    &nbsp;<span id="fav">-</span>
  </div>
  {{endif}}
</div>


<!-- 編集ボタン -->
<div class="ctrl_block">
  {{if $app_id == 0}}
    <p><button onclick="saveClick()" class="pure-button">新規保存</button></p>
  {{else}}
    {{if n3s_is_login()}}
      {{if ($my_user_id === $user_id) || n3s_is_admin()}}
      <p><button onclick="saveClick()" class="pure-button">編集</button></p>
      {{endif}}
    {{endif}}
  {{endif}}
</div>

{{if $app_id gt 0}}
<div class="ctrl_block" style="text-align:right;">
  <div>
    <span id="bad">-</span>&nbsp;
    <button id="bad_button" class="pure-button">通報</button>
  </div>
  <div>&nbsp;</div>
  <div class="memo"><a href="{{$badlink}}">通報って何？</a></div>
</div>
{{endif}}

<!-- script for nadesiko3 -->
{{ $import_nako | raw }}

<!-- script for nako3storage-->
<script type="text/javascript">
  // nako3storage info
  const baseurl = "{{ $baseurl | safe }}";
  const editlink = "{{ $editlink  | safe }}";
  // nako3 program info
  const app_id = {{ $app_id }};
  const nako_version = "{{ $version }}" + ".0.0.0"
</script>
<script defer type="text/javascript"
  src="{{e:echo n3s_getURL('nako3storage_show.js', 'file', ['m'=>$mtime_nako3storage_show]);}}"></script>

{{ include parts_html_footer.html }}
