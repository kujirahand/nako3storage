{{ include parts_html_header.html }}

<style>
#iframe_contents {
    margin: 0px;
    padding: 0px;
    border: 0px none;
    width: 100%;
    height: 400px;
}
</style>

<div class="showblock">
  <div>
    <h1>
      {{ $title | check_mudai }}
      {{if $is_private == 0}}ğŸ“–{{endif}}
      {{if $is_private == 1}}ğŸ”’{{endif}}
      {{if $is_private == 2}}ğŸ”{{endif}}
    </h1>
    <p class="memo">{{ $memo }}</p>
  </div>
  <div id="progrram_area">
    <label>ãƒ—ãƒ­ã‚°ãƒ©ãƒ : <span id="sizeSwitch">(â†’å¤§)</span><br />
    <textarea id="nako3code" readonly>{{ $body }}</textarea>
    </label><br />
    {{ if $nakotype eq 'wnako' }}
      <button id="runButton" style="display:none"></button>
      <button id="clearButton" style="display:none"></button>
      <!-- widget -->
      {{ if $is_private == 1 }}
      <a href="index.php?action=edit&page={{$app_id}}" class="pure-button">ğŸ“ç·¨é›†ãƒšãƒ¼ã‚¸ã§å®Ÿè¡Œ</a>
      {{ else }}
      <iframe id="iframe_contents" src="{{ $sandbox_url }}" sandbox="{{$sandbox_params}}"></iframe>
      {{ endif }}
      <!-- /widget -->
    {{ else }}
      <button id="runButton" style="display:none"></button>
      <button id="clearButton" style="display:none"></button>
    {{ endif }}
  </div>
  
  <!-- #runbox ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã¯å¿…ãšå¿…è¦ -->
  <div id="runbox"></div>
  <!-- /#runbox -->

  <ul class="devblock">
    <li>
      <span>
        {{if $user_id gt 0}}
          <a href="index.php?action=list&user_id={{$user_id}}">
            <img src="{{$profile_url}}" width="48" height="48">
            {{ $author | check_nanasi }} ä½œ
          </a>
        {{else}}
          {{ $author | check_nanasi }} ä½œ
        {{endif}}
        {{ if $url }}
          (<a href="{{$url}}">é–¢é€£URL</a>)
        {{ endif }}
      </span>
    </li>
    <li>
      <span class="lbl">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹:</span> {{ $copyright }}
      ({{e:echo $copyright_desc[$copyright]}})
    </li>
    <li><span class="lbl">ã‚¿ã‚¤ãƒ—:</span> {{ $nakotype }}</li>
    <li><span class="lbl">ã‚¿ã‚°:</span> {{ $tag_link | raw }}</li>
    <li><span class="lbl">åˆ©ç”¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³:</span> {{ $version }}</li>
    <li>
      <span class="lbl">æŠ•ç¨¿æ—¥æ™‚:</span> {{ $ctime | datetime }}
      {{ if $ctime != $mtime }}
        (ç·¨é›†: {{$mtime | datetime}})
      {{ endif }}
    </li>
    {{if $is_private == 0}}
    <li><span class="private">å…¬é–‹ã®æŠ•ç¨¿</span></li>
    {{endif}}
    {{if $is_private == 1}}
    <li><span class="private">ğŸ”’ éå…¬é–‹ã®æŠ•ç¨¿</span></li>
    {{endif}}
    {{if $is_private == 2}}
    <li><span class="private">ğŸ” é™å®šå…¬é–‹ã®æŠ•ç¨¿</span></li>
    {{endif}}
  </ul>

  <!-- .fav_block-->
  {{ if $is_private == 0 }}
  <div class="fav_block" style="border:1px dotted silver;">
    {{if n3s_is_login()}}
    <button id="fav_button" class="pure-button"
      data-bookmark="{{if $bookmark}}1{{else}}0{{endif}}">
      ğŸŒŸ {{if $bookmark}}è§£é™¤{{else}}æ°—ã«å…¥ã£ãŸ{{endif}}
    </button>
    {{else}}
    {{endif}}
    <a name="fav">&nbsp;</a>
    <span>
      <a style="text-decoration:none;" 
        href="index.php?action=fav&page={{$app_id}}&m=who">
        <span id="fav">{{ $fav | star }}</span>
      </a>
      {{ if !n3s_is_login() }}
        &nbsp; &nbsp; &nbsp; &nbsp;
        <span style="font-size:0.8em; color:#999;">
        {{e: $backurl = urlencode("index.php?action=show&page={$app_id}#fav"); }}
        <a href="index.php?action=login&back={{ $backurl }}">
          ãƒ­ã‚°ã‚¤ãƒ³</a>ã—ã¦â˜…ã‚’ä»˜ã‘ã‚ˆã†ï¼</span>
      {{ endif }}
  </div>
  <div class="fav_block">
    <!-- twwiter button -->
    {{if isset($screen_name) && $screen_name != '' }}
    <a class="pure-button" href="https://twitter.com/share?url={{$n3s_baseurl}}/id.php?{{$app_id}}&text=@{{$screen_name}}%20{{$title}}%20#ãªã§ã—ã“ã•ã‚“">Twitterã¸æŠ•ç¨¿</a>
    {{endif}}
  </div>
  {{ endif }}
  <!-- /.fav_block-->
</div><!-- /.showblock-->

<!-- ç·¨é›†ãƒœã‚¿ãƒ³(ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãªãã¦ã‚‚ç·¨é›†ã™ã‚‹ã“ã¨ã¯ã‚ã‚‹) -->
<div class="ctrl_block">
  <a href="index.php?action=edit&page={{$app_id}}" class="pure-button">ğŸ“ä½œå“ã‚’ç·¨é›†</a>
</div>

<!-- URLã‚’è¡¨ç¤º -->
<div class="ctrl_block">
  <h1>ä½œå“å…¬é–‹æƒ…å ±</h1>

  {{ if $is_private == 1 }}
  <div class="blogparts">
    <span>ğŸ”’éå…¬é–‹ã®ä½œå“ã§ã™ã€‚</span>
  </div>
  {{ endif }}

  {{ if $is_private != 1 }}
  <div class="blogparts">
    <span class="memo">ğŸ“ã“ã®ä½œå“ã®URL: </span><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{$n3s_baseurl}}/id.php?{{$app_id}}"><br>
      {{ if $app_name }}
      <input class="info_link" type="text" onclick="this.select()"
      value="{{$n3s_baseurl}}/show/{{$app_name}}"><br>
      {{ endif }}
  </div>
  <div class="blogparts">
    <!-- url-->
    <span class="memo">ğŸ“ã‚¢ãƒ—ãƒª(å³æ™‚å®Ÿè¡Œ)ã®URL: </span><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{ $widget_url_run }}"><br>
    <!-- url-->
    <span class="memo">ğŸ“ã‚¢ãƒ—ãƒª(å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚ã‚Š)ã®URL: </span><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{ $widget_url }}"><br>
    <!-- url-->
    <span class="memo">ğŸ“ãƒ–ãƒ­ã‚°ãƒ‘ãƒ¼ãƒ„: </span><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{ $widget_tag }}"><br>
    <!-- èª¬æ˜ -->
    <p class="memo" style="text-align: right;">ä¸Šè¨˜HTMLâ†‘ã‚’ãƒ–ãƒ­ã‚°ã«è²¼ã‚Šä»˜ã‘ã‚‹ã“ã¨ã§ã‚¢ãƒ—ãƒªã‚’åŸ‹ã‚è¾¼ã‚ã¾ã™ã€‚</p>
  </div>
  {{ endif }}

  {{ if $is_private == 0 }}
  <div class="blogparts">
    <span class="memo">ğŸ“ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç›´ãƒªãƒ³ã‚¯ - ã€!ã€Œ***ã€ã‚’å–è¾¼ã€ã§ä½¿ã†ã¨ã: </span><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{$n3s_baseurl}}/plain/{{ $app_name_or_id }}{{ $ext }}"><br>
    <input class="info_link" type="text" onclick="this.select()"
      value="{{$n3s_baseurl}}/index.php?action=plain&page={{$app_id}}"><br>
  </div>
  {{ endif }}

</div><!-- /ctrl_block --><!-- /URL -->

<div class="ctrl_block" style="text-align:right;">
  <div class="memo">
    é€šå ±æ•°:<span id="bad">{{$bad}}</span>
  </div>
  <div class="memo">
    <a href="{{$badlink}}">é€šå ±ã£ã¦ä½•ï¼Ÿ</a>
  </div>
{{if $app_id gt 0 && n3s_is_login()}}
  <br>
  <div>
    <button id="bad_button" class="pure-button">é€šå ±ã™ã‚‹</button>
  </div>
{{endif}}
  <div>&nbsp;</div>
</div>

<!-- script for ace editor -->
{{ $import_editor | raw }}
<!-- script for nadesiko3 -->
{{ $import_nako | raw }}

<!-- script for nako3storage-->
<script>
// nako3storage_show.js ã‹ã‚‰å‚ç…§ã™ã‚‹å¤‰æ•°
var setValue = function() { alert("ç¾åœ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚") }
var getValue = function() { alert("ç¾åœ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚"); return "" }
var editorObjects = null
var msie = {{e:echo ($msie)?'true':'false'}};

// nako3storage info
const baseurl = "{{ $baseurl | safe }}";

// nako3 program info
const app_id = {{ $app_id }};
const nako_version = "{{ $version }}" + ".0.0.0"
const runbox_c = document.getElementById('runbox')
runbox_c.style.display = 'none'

// iframe ã®é«˜ã•ã‚’èª¿æ•´
window.addEventListener('message', function(e) {
  var iframe = document.querySelector("#iframe_contents")
  var eventName = e.data[0]
  var data = e.data[1]
  switch(eventName) {
  case 'setFrameHeight':
    iframe.style.height = data + 'px'
    break;
  }
}, false)

</script>
<script defer src="{{e:echo n3s_getURL('nako3storage_edit.js', 'file', ['m'=>$mtime_nako3storage_edit]);}}"></script>
<script defer src="{{e:echo n3s_getURL('nako3storage_show.js', 'file', ['m'=>$mtime_nako3storage_show]);}}"></script>

{{ include parts_html_footer.html }}
